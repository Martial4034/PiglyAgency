<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret</title>
    <link rel="stylesheet" href="./src/assets/secret.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
</head>

<body>
    <div class="intro">
        <h1 class="intro-title">A Stranger Lovers</h1>

        <p class="intro-text intro-text--can">
            <button class="intro-text-play" data-play>&#9654;</button>
        </p>

        <p class="intro-text intro-text--shouldnt">
            Unfortunately this demo uses many features only found in the latest
            version of Google Chrome. You can still run this, but it may not look
            as intended. Please try running it in Chrome for the best experience.
            <br />
            <a class="intro-text-button" href="https://www.google.com/chrome/browser/">
                Download Chrome
            </a>
            <button class="intro-text-button" data-play>
                Play Anyway
            </button>
        </p>

        <p class="intro-text intro-text--cant">
            Unfortunately your browser doesn't support this demo. Please download
            Google Chrome, and try running it again.
            <br />
            <a class="intro-text-button" href="https://www.google.com/chrome/browser/">
                Download Chrome
            </a>
        </p>

        <noscript>
            The following demo requires javascript to run. Please enable it and
            refresh the browser.
        </noscript>
    </div>

    <div class="viewport">
        <div class="scene">
            <div class="title title--full">
                <div class="title-word">
                    <span class="title-word-letter" data-letter="S1">
                        <span class="title-word-letter-large">S</span>
                        <div class="titlebar titlebar--left"></div>
                    </span>
                    <span class="title-word-letter" data-letter="T1">T</span>
                    <span class="title-word-letter" data-letter="R1">R</span>
                    <span class="title-word-letter" data-letter="A">A</span>
                    <span class="title-word-letter" data-letter="N1">N</span>
                    <span class="title-word-letter" data-letter="G1">G</span>
                    <span class="title-word-letter" data-letter="E">E</span>
                    <span class="title-word-letter" data-letter="R2">
                        <span class="title-word-letter-large">R</span>
                        <div class="titlebar titlebar--right"></div>
                    </span>
                    <div class="titlebar titlebar--top"></div>
                </div>

                <div></div>

                <div class="title-word title-word--second">
                    <span class="title-word-letter" data-letter="T2">L</span>
                    <span class="title-word-letter" data-letter="H">O</span>
                    <span class="title-word-letter" data-letter="I">V</span>
                    <span class="title-word-letter" data-letter="N2">E</span>
                    <span class="title-word-letter" data-letter="G2">R</span>
                    <span class="title-word-letter" data-letter="S2">S</span>
                </div>
            </div>

            <div class="title title--scene title--scene0"></div>
            <div class="title title--scene title--scene1">
                <div class="title-word">
                    <div class="title-word-letter" data-letter="A">A</div>
                </div>
            </div>
            <div class="title title--scene title--scene2">
                <div class="title-word">
                    <div class="title-word-letter" data-letter="N">N</div>
                </div>
            </div>
            <div class="title title--scene title--scene3">
                <div class="title-word">
                    <div class="title-word-letter" data-letter="R">R</div>
                    <div class="title-word-letter" data-letter="I">I</div>
                </div>
            </div>
            <div class="title title--scene title--scene4">
                <div class="title-word">
                    <div class="title-word-letter" data-letter="S">S</div>
                    <div class="title-word-letter" data-letter="G">G</div>
                </div>
            </div>
            <div class="title title--scene title--scene5">
                <div class="title-word">
                    <div class="title-word-letter" data-letter="R">R</div>
                    <div class="title-word-letter" data-letter="S">S</div>
                </div>
            </div>
            <div class="title title--scene title--scene6">
                <div class="title-word">
                    <div class="title-word-letter" data-letter="I">I</div>
                    <div class="title-word-letter" data-letter="A">A</div>
                    <div class="title-word-letter" data-letter="T">T</div>
                    <div class="title-word-letter" data-letter="H">H</div>
                    <div class="title-word-letter" data-letter="N">N</div>
                    <div class="title-word-letter" data-letter="G">G</div>
                </div>
            </div>
        </div>

        <div class="credits">
            <div class="credits-group">
                <div class="credits-group-credit">
                    A Netflix Original Series
                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-credit" data-text="MADE WITH">
                    MADE WITH
                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-credit">

                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-credit" data-text="PURELY LOVE">
                    PURELY LOVE
                </div>
                <div class="credits-group-credit" data-text="UNE AVENTURE">
                    UNE AVENTURE
                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-credit" data-text="POUR">
                    POUR
                </div>
                <div class="credits-group-credit" data-text="MA ZOÉ d'Amour">
                    MA ZOÉ d'Amour
                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-credit" data-text="">

                </div>
                <div class="credits-group-credit" data-text="PAS MAL D'HEURE DE CODAGE">
                    PAS MAL
                    D'HEURE DE CODAGE
                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-credit" data-text="">

                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-sub" data-text="MAIS">
                    MAIS
                </div>
                <div class="credits-group-credit" data-text="SURTOUT DE L'AMOUR">
                    SURTOUT DE L'AMOUR
                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-sub" data-text="">

                </div>
                <div class="credits-group-credit" data-text="">

                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-sub" data-text="">

                </div>
                <div class="credits-group-credit" data-text="">

                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-sub" data-text="">

                </div>
                <div class="credits-group-credit" data-text="">

                </div>
                <div class="credits-group-credit" data-text="">

                </div>
                <div class="credits-group-credit" data-text="">

                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-sub" data-text="J'ESPERE QUE">
                    J'ESPERE QUE
                </div>
                <div class="credits-group-credit" data-text="">

                </div>
                <div class="credits-group-credit" data-text="">

                </div>
            </div>

            <div class="credits-group">
                <div class="credits-group-sub" data-text="TU VA AIMER">
                    TU VA AIMER
                </div>
                <div class="credits-group-credit" data-text="">

                </div>
            </div>

            <div class="credits-final">
                <div class="credits-group-sub" data-text="Created By">
                    Created By
                </div>
                <div class="credits-group-credit" data-text="Whyte Duke">
                    Whyte Duke
                </div>
            </div>
        </div>
    </div>

    <div class="vignette"></div>
    <div class="grain"></div>
    <div class="letterbox">
        <div class="letterbox-cover letterbox-cover--top"></div>
        <div class="letterbox-cover letterbox-cover--left"></div>
        <div class="letterbox-cover letterbox-cover--right"></div>
        <div class="letterbox-cover letterbox-cover--bottom"></div>
    </div>

    <script>
        // Real quick add another modernizr check foooor...
        Modernizr.addTest("textstroke", function () {
            var h1 = document.createElement("h1");
            if (!("webkitTextStroke" in h1.style) && !("textStroke" in h1.style)) {
                return false;
            } else {
                return true;
            }
        });

        document.addEventListener("DOMContentLoaded", () => {
            let bind = false;
            let text = null;

            // Must-haves
            if (!Modernizr.audio || !Modernizr.cssanimations || !Modernizr.textshadow) {
                text = document.getElementsByClassName("intro-text--cant")[0];
            }
            // Should-haves
            else if (!Modernizr.textstroke) {
                bind = true;
                text = document.getElementsByClassName("intro-text--shouldnt")[0];
            }
            // All good!
            else {
                bind = true;
                text = document.getElementsByClassName("intro-text--can")[0];
            }

            text.className += " intro-text--show";

            if (bind) {
                const btns = document.querySelectorAll("[data-play]");
                for (let i = 0; i < btns.length; i++) {
                    btns[i].addEventListener("click", () => {
                        start();
                    });
                }
            }
        });

        // Fade out intro, start music and animation
        let started = false;
        function start() {
            if (started) {
                return;
            }
            started = true;

            const intro = document.getElementsByClassName("intro")[0];

            const music = new Audio(
                "https://s3-us-west-2.amazonaws.com/s.cdpn.io/161676/music.mp3"
            );

            intro.className += " intro--hide";

            music.addEventListener("canplay", () => {
                setTimeout(() => {
                    startAnimation();
                    setTimeout(() => {
                        music.play();
                    }, 200);
                }, 1500);
            });
        }

        // Kick off the animation
        function startAnimation() {
            // In milliseconds, how long each one is
            const creditsMs = 3000;
            const scenesMs = [
                creditsMs,
                creditsMs * 2,
                creditsMs,
                creditsMs,
                creditsMs,
                creditsMs,
                creditsMs * 2,
                19500
            ];

            // Elements
            const viewport = document.getElementsByClassName("viewport")[0];
            const letterbox = document.getElementsByClassName("letterbox")[0];
            const scenes = document.getElementsByClassName("title--scene");
            const fullTitle = document.getElementsByClassName("title--full")[0];
            const credits = document.getElementsByClassName("credits-group");
            const finalCredit = document.getElementsByClassName("credits-final")[0];

            viewport.className += " viewport--show";
            letterbox.className += " letterbox--show";

            // Set up credits to show every interval
            let activeCredits = null;
            for (let i = 0; i < credits.length; i++) {
                setTimeout(() => {
                    if (credits[i - 1]) {
                        credits[i - 1].className = "credits-group";
                    }
                    credits[i].className = "credits-group credits-group--show";
                }, i * creditsMs);

                if (!credits[i + 1]) {
                    setTimeout(() => {
                        credits[i].className = "credits-group";
                    }, i * creditsMs + creditsMs);
                }
            }

            // Set up scenes to show after each interval
            let offset = 0;
            for (let i = 0; i < scenes.length; i++) {
                setTimeout(() => {
                    if (scenes[i - 1]) {
                        scenes[i - 1].className = scenes[i - 1].className.replace(
                            "title--show",
                            ""
                        );
                    }
                    scenes[i].className += " title--show";
                }, offset);

                offset += scenesMs[i];

                if (!scenes[i + 1]) {
                    // Show the last scene
                    setTimeout(() => {
                        scenes[i].className = scenes[i].className.replace("title--show", "");
                        fullTitle.className += " title--show";
                    }, offset);

                    // Show the final credits
                    setTimeout(() => {
                        finalCredit.className += " credits-group--show";
                    }, offset + scenesMs[i + 1] + 1500);
                }
            }
        }

    </script>
</body>

</html>